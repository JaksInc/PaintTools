<html>
    <head>
        <title>Paint Tools Alpha</title>
        <!-- This section is for PWA stuff -->
        <link rel="stylesheet" href="all-pages.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <meta name="description" content="Tools for the paint desk.">
        <meta name="theme-color" content="#888888">
        <link rel="manifest" href="manifest.json">
        <script>
            if ("serviceWorker" in navigator) {
                window.addEventListener("load", function() {
                    navigator.serviceWorker.register("sw.js");
                });
            }
        </script>
        <!-- End PWA stuff -->
    </head>

<body onload="addRow()">
    <h1 id="page-title">Paint Color Scaler</h1>
    <!-- Where the rows of formula stuff go -->
    <div id="layoutContainer">
        <!-- <div class="row">
            <select class="selectedColor">
                <option value="Select color">Select color</option>
                <option value="AXL">AXL</option>
                <option value="BL">BL</option>
                <option value="CL">CL</option>
                <option value="DL">DL</option>
                <option value="EL">EL</option>
                <option value="FL">FL</option>
                <option value="IL">IL</option>
                <option value="JL">JL</option>
                <option value="KXL">KXL</option>
                <option value="LL">LL</option>
                <option value="RL">RL</option>
                <option value="RUL">RUL</option>
                <option value="TL">TL</option>
                <option value="VL">VL</option>
                <option value="VUL">VUL</option>
                <option value="YL">YL</option>
            </select>
            <input class="ounces" placeholder="Ounces" type="number" min="0" max="100">
            <input class="drops" placeholder="Drops" type="number" min="0" max="383">
            <input class="percentage" placeholder="Percentage" type="number" min="-99999" max="99999">
            <input class="newOunces" placeholder="Output" size="3" disabled="true">
            <input class="newDrops" placeholder="Output" size="3" disabled="true">
        </div> -->
    </div>
    <button id="scaleButton">Scale</button><button id="addRowButton">Add Row</button>
</body>

<!-- Navigation bar -->
<nav>
    <li>
        <a href="scaler.html" class="active">Scaler</a>
    </li><li>
        <a href="combiner.html">Combiner</a>
    </li><li>
        <a href="">Third Page</a>
    </li><li>
        <a href="">Forth Page</a>
    </li><li>
        <a href="">Fifth Page</a>
    </li>
</nav>
</html>


<script>
    //Adds event listeners for the two buttons
    const scaleButton = document.querySelector("#scaleButton");
    scaleButton.addEventListener("click", calculateNewFormula);
    const addRowButton = document.querySelector("#addRowButton");
    addRowButton.addEventListener("click", addRow);

    //Gets our layoutcontainer for adding rows
    const layoutContainer = document.querySelector("#layoutContainer");


    function calculateNewFormula() {
        //When the "Scale" button is pressed, it will calculate the results for every row and put them in the output slots.
        for (let i = 0; i < layoutContainer.childElementCount; i++) {
            currentRow = layoutContainer.children[i]

            //Get the values from the current row
            // let selectedColor = currentRow.querySelector(".selectedColor").value;
            let ounces = + currentRow.querySelector(".ounces").value;
            let drops = + currentRow.querySelector(".drops").value;
            let percentage = + currentRow.querySelector(".percentage").value;

            //Math time
            let totalDrops = (ounces * 384) + drops;
            let totalDropsAfterScaling = totalDrops * ((percentage + 100) / 100);

            let newOunces = Math.floor(totalDropsAfterScaling / 384);
            let newDrops = Math.round((totalDropsAfterScaling % 384) * 2) / 2;

            //Set the two result boxes values
            currentRow.querySelector(".newOunces").value = newOunces;
            currentRow.querySelector(".newDrops").value = newDrops;
        }
    }

    function addRow() {
        //Adds a new row with all the inputs and outputs
        let selectedColor = document.createElement("select");
        let colors = ["Select color", "AXL", "BL", "CL", "DL", "EL", "FL", "IL", "JL", "KXL", "LL", "RL", "RUL", "TL", "VL", "VUL", "YL"]
        for (let i = 0; i < colors.length; i++) {
            let option = document.createElement("option")
            option.value = colors[i]
            option.text = colors[i]
            selectedColor.appendChild(option)
        }
        selectedColor.setAttribute("class", "selectedColor")

        let ounces = document.createElement("input");
        ounces.setAttribute("class", "ounces");
        ounces.setAttribute("placeholder", "Ounces");
        ounces.setAttribute("type", "number");
        ounces.setAttribute("min", "0");
        ounces.setAttribute("max", "100");

        let drops = document.createElement("input");
        drops.setAttribute("class", "drops");
        drops.setAttribute("placeholder", "Drops");
        drops.setAttribute("type", "number");
        drops.setAttribute("min", "0");
        drops.setAttribute("max", "383");


        let percentage = document.createElement("input");
        percentage.setAttribute("class", "percentage");
        percentage.setAttribute("placeholder", "Percentage");
        percentage.setAttribute("type", "number");
        percentage.setAttribute("min", "-99999");
        percentage.setAttribute("max", "99999");

        let newOunces = document.createElement("input");
        newOunces.setAttribute("class", "newOunces");
        newOunces.setAttribute("placeholder", "Output");
        newOunces.setAttribute("size", "3");
        newOunces.setAttribute("disabled", "true");

        let newDrops = document.createElement("input");
        newDrops.setAttribute("class", "newDrops");
        newDrops.setAttribute("placeholder", "Output");
        newDrops.setAttribute("size", "3");
        newDrops.setAttribute("disabled", "true");

        let newDiv = document.createElement("div");
        newDiv.setAttribute("class", "row")

        newDiv.appendChild(selectedColor);
        newDiv.appendChild(ounces);
        newDiv.appendChild(drops);
        newDiv.appendChild(percentage);
        newDiv.appendChild(newOunces);
        newDiv.appendChild(newDrops);

        layoutContainer.appendChild(newDiv);
    }
</script>

<style>
    /* CSS related to this page only */
    /* Sections of each row */
    #layoutContainer {
        display: table;
    }
    #layoutContainer>div {
        display: table-row;
    }
    #layoutContainer>div>* {
        display: table-cell;
        width: 24%;
        min-width: min-content;
        max-width: 100px;
        padding-top: 10px;
        padding-bottom: 10px;
        margin-left: 1%;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
</style>