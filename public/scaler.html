<!DOCTYPE html>
<html>
<head>
    <title>Paint Tools Alpha</title>
    <script src="common.js"></script>
</head>
<body>
    <h1 id="page-title">Color Scaler</h1>
    <div id="colorsContainer">
        <div id="colorA" class="color">
            <div class="formulaRow">
                <select class="selectedColor"></select>
                <input class="ounces" placeholder="Ounces" type="number" min="0" max="100">
                <input class="drops" placeholder="Drops" type="number" min="0" max="383">
                <input class="percentage" placeholder="Percentage" type="number" min="-1000" max="1000">
            </div>
            <div class="formulaRow">
                <select class="selectedColor"></select>
                <input class="ounces" placeholder="Ounces" type="number" min="0" max="100">
                <input class="drops" placeholder="Drops" type="number" min="0" max="383">
                <input class="percentage" placeholder="Percentage" type="number" min="-1000" max="1000">
            </div>
            <div class="formulaRow">
                <select class="selectedColor"></select>
                <input class="ounces" placeholder="Ounces" type="number" min="0" max="100">
                <input class="drops" placeholder="Drops" type="number" min="0" max="383">
                <input class="percentage" placeholder="Percentage" type="number" min="-1000" max="1000">
            </div>
            <div class="formulaRow">
                <select class="selectedColor"></select>
                <input class="ounces" placeholder="Ounces" type="number" min="0" max="100">
                <input class="drops" placeholder="Drops" type="number" min="0" max="383">
                <input class="percentage" placeholder="Percentage" type="number" min="-1000" max="1000">
            </div>
            <div class="formulaRow">
                <select class="selectedColor"></select>
                <input class="ounces" placeholder="Ounces" type="number" min="0" max="100">
                <input class="drops" placeholder="Drops" type="number" min="0" max="383">
                <input class="percentage" placeholder="Percentage" type="number" min="-1000" max="1000">
            </div>
        </div>
    </div>
    <button id="scaleButton">Scale</button>
    <h1>Results</h1>
    <div id="resultsArea">
        <table id="resultsTable">
            <tr id="resultColorNames"></tr>
            <tr id="resultOunces"></tr>
            <tr id="resultDrops"></tr>
        </table>
    </div>
    <script>
        const scaleButton = document.querySelector("#scaleButton");
        scaleButton.addEventListener("click", scale);
        const colorsContainer = document.getElementById("colorsContainer");
        colorsContainer.addEventListener("input", scale);
        colorsContainer.addEventListener("change", scale);

        function scale() {
            const formula = createFormulas("#colorsContainer", true)[0];
            const scaledFormula = {};
            for (const colorant in formula) {
                if (colorant == "Select color") {
                    continue;
                }
                let totalDrops = ((formula[colorant][0] * 384) + formula[colorant][1]) * (formula[colorant][2] / 100);
                let ounces = Math.floor(totalDrops / 384);
                let drops = Math.floor((totalDrops % 384) * 100) / 100;
                scaledFormula[colorant] = [ounces, drops];
            };
            displayResults(scaledFormula);
        }
    </script>
</body>
</html>
